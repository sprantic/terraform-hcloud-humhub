<?php

/**
 * HumHub dynamic configuration
 * Generated by Terraform/Ansible
 */

return [
    'components' => [
        'db' => [
            'class' => 'yii\db\Connection',
            'dsn' => 'mysql:host={{ db_host }};dbname=humhub',
            'username' => 'humhub',
            'password' => '{{ db_password }}',
            'charset' => 'utf8mb4',
        ],
        'cache' => [
            'class' => 'yii\redis\Cache',
            'redis' => [
                'hostname' => '{{ redis_host }}',
                'port' => 6379,
                'database' => 0,
            ]
        ],
        'session' => [
            'class' => 'yii\redis\Session',
            'redis' => [
                'hostname' => '{{ redis_host }}',
                'port' => 6379,
                'database' => 1,
            ]
        ],
        'queue' => [
            'class' => 'humhub\modules\queue\driver\Redis',
            'redis' => [
                'hostname' => '{{ redis_host }}',
                'port' => 6379,
                'database' => 2,
            ]
        ],
        'mailer' => [
            'class' => 'yii\swiftmailer\Mailer',
            'viewPath' => '@humhub/modules/mail/views',
            'useFileTransport' => false,
            'transport' => [
                'class' => 'Swift_SmtpTransport',
                'host' => 'localhost',
                'username' => '',
                'password' => '',
                'port' => '25',
                'encryption' => null,
            ],
        ],
    ],
    'params' => [
        'installer' => [
            'db' => [
                'installer_hostname' => '{{ db_host }}',
                'installer_database' => 'humhub',
            ],
        ],
        'config_created_via' => 'Terraform/Ansible',
{% if domain_name %}
        'humhub' => [
            'baseUrl' => '{{ "https" if enable_ssl else "http" }}://{{ domain_name }}',
        ],
{% endif %}
{% if keycloak_integration | default(false) %}
        'keycloak' => [
            'serverUrl' => '{{ keycloak_server_url }}',
            'realm' => '{{ keycloak_realm }}',
            'clientId' => '{{ keycloak_client_id }}',
        ],
{% endif %}
    ],
];